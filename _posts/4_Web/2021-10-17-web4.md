---
layout: "single"
title: "스프링부트와 AWS로 혼자 구현하는 웹 서비스 4 - JPA"
categories: [Web]
tags: [Java, SpringBoot, JPA, ORM, h2]
permalink: /web/4
---

# 3장 스프링 부트에서 JPA로 데이터베이스를 다뤄보자

## 어떻게 관계형 데이터베이스를 이용하는 프로젝트에서 객체지향 프로그래밍을 할 수 있을까?

**반복적인 SQL 작성 문제**

관계형 데이터 베이스가 웹 서비스의 중심이 되면서 현업 프로젝트 대부분이 애플리케이션 코드보다 SQL로 가득해졌다.
관계형 데이터 베이스가 SQL만 인식이 가능하니 테이블마다 CRUD를 매번 생성해야한다.

**패러다임 불일치 문제**

관계형 데이터 베이스는 어떻게 데이터를 저장할지에 초점이 맞춰진 기술이다.
추상화, 캡슐화, 정보은닉, 다형성 등 객체 지향적 요소들을 관계형 데이터베이스로 표현하기는 어렵다.
객체 모델링보다는 테이블 모델링에만 집중하고 객체를 단순히 테이블에 맞추어 데이터 전달 역할만 하는 개발을 하게된다.

## 💜JPA
- 자바 표준 ORM(Object Relational Mapping)
- 객체지향 패러다임과 관계형 데이터베이스의 중간에서 패러다임 일치를 시켜준다.
- 개발자는 객체지향적 프로그래밍을 하고, JPA가 이를 관계형 데이터베이스에 맞게 SQL을 대신 생성하고 실행한다.

### 장점
- 생산성 향상
  - CRUD 코드를 직접 작성할 필요가 없다. 

### 단점
- 높은 러닝 커브
  - OOP와 RDB를 둘 다 이해하고 있어야한다.

### 속도이슈는 없을까?
- JPA에서 제시하는 여러 성능 이슈 해결책들을 잘 활용하면 충분히 네이티브 쿼리만큼의 퍼포먼스를 낼 수 있다.

## 💜Spring Data JPA
JPA는 인터페이스이다. 즉, Implement된 구현체가 필요하다. 
대표적인 구현체는 Hibernate, Eclipse Link 등이 있다.
Spring에서는 이 구현체들을 더 쉽게 사용하고자 추상화시킨 **Spring Data JPA**라는 모듈을 제공한다.

- `JPA <- Hibernate <- Spring Data JPA`

#### Hibernate 대신 Spring Data JPA를 사용하는 이유?
- 구현체 교체 용이
  - 언젠가 필요에 따라 Hibernate 말고 다른 구현체로 쉽게 교체할 수 있다.
- 저장소 교체 용이
  - 최초에 관계형 데이터베이스로 서비스를 출시했더라도, 의존성만 수정하면 MongoDB 등 다른 데이터베이스로 쉽게 교체할 수 있다.

## 💜프로젝트에 Spring Data JPA 적용하기

프로젝트 내 **build.gradle** 파일에 다음 의존성 추가

```groovy

dependencies {
    ...

    implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
    implementation 'com.h2database:h2'
    
    ...
}
```

>Gradle 6.9.1 버전 기준

🥕 *h2 Database?*

- 자바 SQL 데이터베이스
- in-memory 관계형 데이터베이스
- 빠른 속도, [오픈소스](https://github.com/h2database/h2database), JDBC API 
- 2.5MB 정도 사이즈의 작은 jar 설치 파일
  - 별도의 설치없이 프로그램 의존성으로도 관리가능
- 브라우저 기반의 콘솔 애플리케이션
  - 기본적으로 `/h2-console`에서 콘솔을 사용할 수 있다. `spring.h2.console.path`속성 을 변경하여 콘솔 경로를 사용자정의할 수 있다.
- 메모리에서 실행되어 프로그램 재시작 시 초기화
  - JPA 테스트 및 로컬 테스트 용도

![211017145159.png](/assets/images/211017145159.png)

![211017144311.png](/assets/images/211017144311.png)

![211017144258.png](/assets/images/211017144258.png)

<br>

>Reference
- [스프링부트와 AWS로 혼자 구현하는 웹 서비스](https://jojoldu.tistory.com/463)
- [Spring Guide : Accessing data jpa](https://spring.io/guides/gs/accessing-data-jpa/)
- [H2 Database Engine](https://www.h2database.com/html/main.html)
- [MVN Repository : spring-boot-starter-data-jpa](https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-data-jpa)
- [MVN Repository : com.h2database](https://mvnrepository.com/artifact/com.h2database/h2)
- [wannaqueen GitBook : 31.5 H2의 웹 콘솔 사용](https://wannaqueen.gitbook.io/spring5/spring-boot/undefined-1/31.-sql-by-ys/31.5-h2)